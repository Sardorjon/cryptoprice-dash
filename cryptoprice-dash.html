<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">

<dom-module id="cryptoprice-dash">
    <template>
        <h2>Hello Sardor</h2>
        <iron-ajax id = "coinbase" handle-as = "json" on-response = "_handleResponse">
    </template>

    <script>
         class CryptopriceDash extends Polymer.Element {
             static get is() {return "cryptoprice-dash" }
             static get properties(){
                 return{
                     currencies: {
                         type: Array,
                         value: [
                             {
                                 code:'LTC',
                                 name: 'Litecoin'
                             },
                             {
                                 code:'BTC',
                                 name: 'Bitcoin'
                             },
                             {
                                 code:'ETH',
                                 name: 'Ethereum'
                             }
                         ]
                     }
                 }
                
             }

             ready(){
                     super.ready();
                     Polymer.RenderStatus.afterNextRender(this, function(){
                         this._getCurrenyData();
                     })
                 }
                 _getCurrenyData() {
                     var ajax = this.$.coinbase;
                     var currencies = this.currencies;
                     currencies.forEach(function(element){
                         ajax.url = 'https://www.coinbase.com/api/v2/prices/' + element.code + '-USD/spot';
                         ajax.generateRequest();
                     }, this);
                    }
                    _handleResponse(response) {
                        console.log(response);
                    }

          }
            window.customElements.define(CryptopriceDash.is, CryptopriceDash);
    </script>

</dom-module>